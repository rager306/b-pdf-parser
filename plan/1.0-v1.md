I have created the following plan after thorough exploration and analysis of the codebase. Follow the below plan verbatim. Trust the files and references. Do not re-verify what's written in the plan. Explore only when absolutely necessary. First implement all the proposed file changes and then I'll review all the changes together at the end.

## ðŸ“Š Observations

The repository is currently empty. Three sample Indonesian bank statement PDFs ("Rekening Koran") are available in `source-pdf/`. These statements contain metadata (Account No, Business Unit, Product Name, Statement Date) and transaction tables with columns: Date, Description, User, Debit, Credit, Balance. PyMuPDF requires version â‰¤1.26.5 for Python 3.9 compatibility. The task requires comparing three parsing libraries (PyMuPDF, pdfplumber, pypdf) with multiprocessing support for 1000+ files, achieving <2 sec/page performance and 90%+ accuracy.

## ðŸŽ¯ Approach

Create a modular parser structure with three independent implementations (PyMuPDF, pdfplumber, pypdf) sharing common utilities. Use regex patterns to extract metadata from the first page header and transaction rows from all pages. Handle multi-line descriptions by detecting date patterns (`DD/MM/YY`) as row delimiters. Implement CSV export functions for metadata and transactions. Provide validation logic to measure parsing success rate. Ensure Python 3.9 compatibility by pinning PyMuPDF to version 1.26.5. All code, comments, and documentation will be in English.

## ðŸ“ Project Structure

```
/root/b-pdf-parser/
â”œâ”€â”€ pdfparser/
â”‚   â”œâ”€â”€ __init__.py          # Export parse_pdf() stub
â”‚   â””â”€â”€ utils.py             # Shared utilities
â”œâ”€â”€ output/
â”‚   â”œâ”€â”€ metadata/            # Metadata CSV outputs
â”‚   â””â”€â”€ transactions/        # Transaction CSV outputs
â”œâ”€â”€ test-pdfs/               # Test dataset directory
â”œâ”€â”€ requirements.txt         # Dependencies
â””â”€â”€ README.md               # English documentation
```

## ðŸ”§ Implementation Steps

### 1. Create Directory Structure

Create the following directories:
- `pdfparser/` - main parser module
- `output/metadata/` - for metadata CSV files
- `output/transactions/` - for transaction CSV files  
- `test-pdfs/` - for synthetic test PDFs (1000+ files)

### 2. Implement `pdfparser/utils.py`

**Purpose:** Shared utilities for all parser implementations

**Regex Patterns:**

```python
# Metadata extraction patterns
ACCOUNT_NO_PATTERN = r'Account\s+No[:\s]+([^\n]+)'
BUSINESS_UNIT_PATTERN = r'Business\s+Unit[:\s]+([^\n]+)'
PRODUCT_NAME_PATTERN = r'Product\s+Name[:\s]+([^\n]+)'
STATEMENT_DATE_PATTERN = r'Statement\s+Date[:\s]+([^\n]+)'

# Transaction row pattern (date as anchor)
TRANSACTION_DATE_PATTERN = r'^\d{2}/\d{2}/\d{2}'

# Full transaction line pattern (with optional columns)
TRANSACTION_LINE_PATTERN = r'^(\d{2}/\d{2}/\d{2})\s+(.+?)\s+(\w+)\s+([\d,.]+)?\s+([\d,.]+)?\s+([\d,.]+)
```

**Functions to implement:**

- `extract_metadata(text: str) -> dict` - Apply regex patterns to extract metadata fields, return dict with keys: `account_no`, `business_unit`, `product_name`, `statement_date`

- `extract_transactions(text: str) -> list[dict]` - Parse transaction lines:
  - Split text into lines
  - Detect transaction rows starting with date pattern
  - Merge multi-line descriptions (lines without date prefix belong to previous transaction)
  - Parse columns: date, description, user, debit, credit, balance
  - Return list of dicts with keys: `date`, `description`, `user`, `debit`, `credit`, `balance`

- `save_metadata_csv(metadata: dict, output_path: str) -> None` - Write metadata dict to CSV with two columns: Field, Value

- `save_transactions_csv(transactions: list[dict], output_path: str) -> None` - Write transactions to CSV with columns: Date, Description, User, Debit, Credit, Balance (use English column names)

- `is_valid_parse(metadata: dict, transactions: list[dict]) -> bool` - Validation logic:
  - Check metadata has at least 2 non-empty fields
  - Check transactions list has at least 1 entry
  - Check each transaction has date and balance fields
  - Return True if valid, False otherwise

**Python 3.9 Compatibility:**
- Use `list[dict]` type hints (available in 3.9+)
- Use `csv` module for CSV operations
- Use `re` module for regex
- Use `pathlib.Path` for file operations

**English Documentation:**
- Add docstrings to all functions
- Include parameter descriptions and return types
- Add inline comments for complex regex patterns

### 3. Implement `pdfparser/__init__.py`

**Purpose:** Module entry point with stub function

**Content:**
```python
"""
PDF Parser for Indonesian Bank Statements (Rekening Koran)

This module provides functions to parse PDF bank statements and extract:
- Metadata (Account No, Business Unit, Product Name, Statement Date)
- Transactions (Date, Description, User, Debit, Credit, Balance)
"""

def parse_pdf(path: str, parser: str = 'pymupdf') -> dict:
    """
    Parse a PDF bank statement file.
    
    Args:
        path: Path to PDF file
        parser: Parser to use ('pymupdf', 'pdfplumber', 'pypdf')
    
    Returns:
        dict with keys:
            - 'metadata': dict of metadata fields
            - 'transactions': list of transaction dicts
    
    Raises:
        ValueError: If parser name is invalid
        FileNotFoundError: If PDF file doesn't exist
    """
    # Stub implementation - will be replaced in subsequent phases
    raise NotImplementedError("Parser implementations coming in next phases")

__all__ = ['parse_pdf']
```

### 4. Create `requirements.txt`

**Dependencies with version constraints:**

```
# PDF parsing libraries
PyMuPDF==1.26.5          # Python 3.9 compatible version
pdfplumber>=0.10.0       # Tested on Python 3.9
pypdf>=3.0.0             # Pure Python, 3.9 compatible

# Test data generation
reportlab>=4.0.0         # For generating synthetic PDFs

# Benchmarking and output
tabulate>=0.9.0          # For formatted benchmark tables
```

**Notes:**
- PyMuPDF pinned to 1.26.5 for Python 3.9 support (newer versions require 3.10+)
- pdfplumber officially tested on Python 3.9
- pypdf is pure Python and compatible with 3.9
- reportlab for generating 1000+ test PDFs
- tabulate for benchmark result formatting

### 5. Create `README.md`

**Structure and content (all in English):**

**Header Section:**
```markdown
# Indonesian Bank Statement PDF Parser

A high-performance Python parser for Indonesian bank statements (Rekening Koran) with support for multiple PDF parsing libraries.

## Features

- âœ… Native PDF parsing (no OCR)
- âœ… Three parser implementations (PyMuPDF, pdfplumber, pypdf)
- âœ… Multiprocessing support for batch processing
- âœ… Performance benchmarking tools
- âœ… Python 3.9 compatible
- âœ… Handles 1000+ files efficiently
```

**Installation Section:**
```markdown
## Installation

### Requirements
- Python 3.9+
- pip

### Setup
```bash
pip install -r requirements.txt
```
```

**Usage Section:**
```markdown
## Usage

### Basic Usage
```python
from pdfparser import parse_pdf

# Parse a single PDF
result = parse_pdf('path/to/statement.pdf')

# Access metadata
print(result['metadata']['account_no'])
print(result['metadata']['statement_date'])

# Access transactions
for txn in result['transactions']:
    print(f"{txn['date']}: {txn['description']} - {txn['balance']}")
```

### Choosing a Parser
```python
# Use PyMuPDF (fastest)
result = parse_pdf('statement.pdf', parser='pymupdf')

# Use pdfplumber (best for tables)
result = parse_pdf('statement.pdf', parser='pdfplumber')

# Use pypdf (pure Python)
result = parse_pdf('statement.pdf', parser='pypdf')
```
```

**Output Format Section:**
```markdown
## Output Format

### Metadata CSV
| Field | Value |
|-------|-------|
| Account No | 041901001548309 |
| Business Unit | Corporate Banking |
| Product Name | Current Account |
| Statement Date | 01/11/2023 - 30/11/2023 |

### Transactions CSV
| Date | Description | User | Debit | Credit | Balance |
|------|-------------|------|-------|--------|---------|
| 01/11/23 | Transfer to... | SYSTEM | 1000000.00 | | 5000000.00 |
```

**Multiprocessing Section:**
```markdown
## Multiprocessing

For processing large batches (1000+ files):

```python
from pdfparser import batch_parse

# Process multiple files in parallel
pdf_files = ['file1.pdf', 'file2.pdf', ...]
results = batch_parse(
    paths=pdf_files,
    parser_name='pymupdf',
    max_workers=8,  # Use 8 CPU cores
    output_dir='output'
)
```

### Performance
- Target: <2 seconds per page
- Tested on: 19/152 CPU, 258 GB RAM
- Accuracy: 90%+ success rate on Indonesian bank statements
```

**Benchmarking Section:**
```markdown
## Benchmarking

Compare parser performance:

```bash
python benchmark.py --parsers all --test-dir test-pdfs --max-files 1000 --max-workers 8
```

Options:
- `--parsers`: `all`, `pymupdf`, `pdfplumber`, `pypdf`
- `--test-dir`: Directory containing PDF files
- `--max-files`: Maximum number of files to test
- `--max-workers`: Number of parallel workers

Results saved to `benchmark_results.csv`
```

**Project Structure Section:**
```markdown
## Project Structure

```
b-pdf-parser/
â”œâ”€â”€ pdfparser/              # Main parser module
â”‚   â”œâ”€â”€ __init__.py        # Public API
â”‚   â”œâ”€â”€ utils.py           # Shared utilities
â”‚   â”œâ”€â”€ pymupdf_parser.py  # PyMuPDF implementation
â”‚   â”œâ”€â”€ pdfplumber_parser.py  # pdfplumber implementation
â”‚   â”œâ”€â”€ pypdf_parser.py    # pypdf implementation
â”‚   â””â”€â”€ batch.py           # Multiprocessing utilities
â”œâ”€â”€ source-pdf/            # Sample PDFs
â”œâ”€â”€ test-pdfs/             # Generated test dataset
â”œâ”€â”€ output/                # Parsed results
â”‚   â”œâ”€â”€ metadata/         # Metadata CSVs
â”‚   â””â”€â”€ transactions/     # Transaction CSVs
â”œâ”€â”€ benchmark.py           # Performance testing script
â”œâ”€â”€ generate_test_pdfs.py  # Test data generator
â”œâ”€â”€ requirements.txt       # Dependencies
â””â”€â”€ README.md             # This file
```
```

**License and Contributing Section:**
```markdown
## License

[Specify license]

## Contributing

Contributions welcome! Please ensure:
- Python 3.9 compatibility
- English documentation and comments
- Unit tests for new features
```

### 6. Analyze Sample PDFs for Regex Tuning

**Action items:**

1. **Examine file:source-pdf/Example_statement.pdf:**
   - Identify exact format of metadata fields
   - Check spacing and delimiters
   - Note any variations in field names

2. **Examine file:source-pdf/NEW_REKENING_KORAN_ONLINE-JAN-2024.pdf:**
   - Verify transaction table structure
   - Check date format consistency
   - Identify column separators (spaces, tabs)

3. **Examine file:source-pdf/NEW_REKENING_KORAN_ONLINE_041901001548309_2023-11-01_2023-11-30_00291071.pdf:**
   - Test multi-line description handling
   - Verify numeric formats (commas, decimals)
   - Check for edge cases (missing columns, special characters)

4. **Refine regex patterns in `utils.py` based on findings:**
   - Adjust whitespace handling
   - Add optional field matching
   - Handle Indonesian language characters
   - Support multiple date formats if needed

**Testing approach:**
- Manually extract text from PDFs using a simple script
- Test regex patterns against extracted text
- Iterate until patterns match all three sample files
- Document any format variations in code comments

## ðŸ” Validation Checklist

- [ ] All directories created (`pdfparser/`, `output/metadata/`, `output/transactions/`, `test-pdfs/`)
- [ ] `pdfparser/__init__.py` exports `parse_pdf()` stub function
- [ ] `pdfparser/utils.py` contains all regex patterns and utility functions
- [ ] `requirements.txt` specifies PyMuPDF==1.26.5 for Python 3.9 compatibility
- [ ] `README.md` written entirely in English with complete documentation
- [ ] All code comments and docstrings in English
- [ ] Regex patterns tested against sample PDFs
- [ ] CSV export functions handle UTF-8 encoding for Indonesian text
- [ ] Validation function checks for minimum data quality

## ðŸ“Š Expected Outcomes

After completing this phase:

1. **Project foundation ready** - Directory structure and module skeleton in place
2. **Shared utilities implemented** - Regex patterns, CSV functions, validation logic
3. **Documentation complete** - README with installation, usage, and multiprocessing examples
4. **Dependencies specified** - Python 3.9 compatible versions pinned
5. **Ready for parser implementations** - Next phases can build on this foundation

## ðŸ”„ Integration with Subsequent Phases

This phase provides the foundation for:

- **Phase 2-4:** Parser implementations (`pymupdf_parser.py`, `pdfplumber_parser.py`, `pypdf_parser.py`) will import from `utils.py`
- **Phase 5:** Benchmark script will use validation functions from `utils.py`
- **Phase 6:** Batch processing will leverage CSV export functions
- **Phase 7:** Test PDF generator will follow structure documented in README

All subsequent implementations will reference:
- `utils.extract_metadata()` for metadata parsing
- `utils.extract_transactions()` for transaction parsing
- `utils.save_metadata_csv()` and `utils.save_transactions_csv()` for output
- `utils.is_valid_parse()` for accuracy measurement